(()=>{"use strict";var e={85:(e,t,n)=>{n.r(t)},509:(e,t,n)=>{n.r(t)},18:(e,t,n)=>{n.r(t)},748:(e,t,n)=>{n.r(t)},272:(e,t,n)=>{n.r(t)},974:(e,t,n)=>{n.r(t)},528:(e,t,n)=>{n.r(t)},234:(e,t,n)=>{n.r(t)},954:(e,t,n)=>{n.r(t)},556:(e,t,n)=>{n.r(t)},517:(e,t,n)=>{n.r(t)},387:(e,t,n)=>{n.r(t)},203:function(e,t){var n=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.saveWinner=t.updateWinner=t.createWinner=t.deleteWinner=t.getWinnerStatus=t.getWinner=t.getWinners=t.updateCar=t.deleteCar=t.createCar=t.getCar=t.getCars=t.drive=t.stopEngine=t.startEngine=void 0;const i="http://localhost:3000",r=`${i}/garage`,a=`${i}/engine`,o=`${i}/winners`;t.startEngine=e=>n(void 0,void 0,void 0,(function*(){return(yield fetch(`${a}?id=${e}&status=started`)).json()})),t.stopEngine=e=>n(void 0,void 0,void 0,(function*(){return(yield fetch(`${a}?id=${e}&status=stopped`)).json()})),t.drive=e=>n(void 0,void 0,void 0,(function*(){const t=yield fetch(`${a}?id=${e}&status=drive`).catch();return 200!==t.status?{success:!1}:Object.assign({},yield t.json())})),t.getCars=(e,t=7)=>n(void 0,void 0,void 0,(function*(){const n=yield fetch(`${r}?_page=${e}&_limit=${t}`);return{items:yield n.json(),count:n.headers.get("X-Total-Count")}})),t.getCar=e=>n(void 0,void 0,void 0,(function*(){return(yield fetch(`${r}/${e}`)).json()})),t.createCar=e=>n(void 0,void 0,void 0,(function*(){return(yield fetch(r,{method:"POST",body:JSON.stringify(e),headers:{"Content-type":"application/json"}})).json()})),t.deleteCar=e=>n(void 0,void 0,void 0,(function*(){return(yield fetch(`${r}/${e}`,{method:"DELETE"})).json()})),t.updateCar=(e,t)=>n(void 0,void 0,void 0,(function*(){return(yield fetch(`${r}/${e}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-type":"application/json"}})).json()})),t.getWinners=({page:e,limit:i=10,sort:r,order:a})=>n(void 0,void 0,void 0,(function*(){const s=yield fetch(`${o}?_page=${e}&_limit=${i}${((e,t)=>e&&t?`&_sort=${e}&_order=${t}`:"")(r,a)}`),d=yield s.json();return{items:yield Promise.all(d.map((e=>n(void 0,void 0,void 0,(function*(){return Object.assign(Object.assign({},e),{car:yield t.getCar(e.id)})}))))),count:s.headers.get("X-Total-Count")}})),t.getWinner=e=>n(void 0,void 0,void 0,(function*(){return(yield fetch(`${o}/${e}`)).json()})),t.getWinnerStatus=e=>n(void 0,void 0,void 0,(function*(){return(yield fetch(`${o}/${e}`)).status})),t.deleteWinner=e=>n(void 0,void 0,void 0,(function*(){return(yield fetch(`${o}/${e}`,{method:"DELETE"})).json()})),t.createWinner=e=>n(void 0,void 0,void 0,(function*(){return(yield fetch(o,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).json()})),t.updateWinner=(e,t)=>n(void 0,void 0,void 0,(function*(){return(yield fetch(`${o}/${e}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).json()})),t.saveWinner=({id:e,time:i})=>n(void 0,void 0,void 0,(function*(){if(404===(yield t.getWinnerStatus(e)))yield t.createWinner({id:e,wins:1,time:i});else{const n=yield t.getWinner(e);yield t.updateWinner(e,{id:e,wins:n.wins+1,time:i<n.time?i:n.time})}}))},752:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;const r=n(563),a=n(785),o=n(854);t.App=class{constructor(e){this.rootElement=e,this.garage=a.Garage.getInstance(),this.controlPanel=r.ControlPanel.getInstance().getControlPanel(),this.winnerList=o.winnerList(),this.render()}render(){return i(this,void 0,void 0,(function*(){yield this.garage.renderGarage(),this.rootElement.append(this.controlPanel,this.garage.getGarage(),this.winnerList)}))}}},310:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createComponent=void 0,t.createComponent=(e,t,n,i,...r)=>{let a;try{a=document.createElement(e)}catch(e){throw new Error("Unable to create HTMLElement! Give a proper tag name")}return t&&a.classList.add(...t.split(" ")),n&&Array.isArray(n)?n.forEach((e=>e&&a.appendChild(e))):n&&"object"==typeof n?a.appendChild(n):n&&"string"==typeof n&&(a.innerHTML=n),i&&i.appendChild(a),r.length&&r.forEach((([e,t])=>{e&&""===t?a.setAttribute(e,""):""===e&&""===t?a.setAttribute("",""):a.setAttribute(e,t)})),a}},113:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createButton=void 0;const i=n(310);n(85),t.createButton=(e,t,...n)=>i.createComponent("button",`button ${t}`,e,null,...n)},166:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.carControlPanel=t.stopDriving=t.startDriving=void 0;const r=n(203),a=n(310),o=n(314),s=n(593),d=n(113);n(509);const c=o.States.getInstance();t.startDriving=(e,t,n,a,o)=>i(void 0,void 0,void 0,(function*(){t.disabled=!0;const{velocity:i,distance:d}=yield r.startEngine(e),l=Math.round(d/i);n.disabled=!1;const u=Math.floor(s.getDistanceBetweenElements(a,o))+70,h=s.animation(a,u,l);c.setAnimation(h);const{success:p}=yield r.drive(e);return p||window.cancelAnimationFrame(h.id),c.setCarRace({success:p,id:e,time:l}),{success:p,id:e,time:l/1e3}})),t.stopDriving=(e,t,n,a)=>i(void 0,void 0,void 0,(function*(){n.disabled=!0,yield r.stopEngine(e),t.disabled=!1,a.style.transform="translateX(0)",c.getAnimation()&&window.cancelAnimationFrame(c.getAnimation().id)})),t.carControlPanel=(e,n,r,o)=>{const s=d.createButton("A","button_border",["id",`start-engine-car-${e}`],[`${o?"disabled":null}`,""]),l=d.createButton("B","button_border",["id",`stop-engine-car-${e}`],[`${o?null:"disabled"}`,""]);return((e,n,r,a)=>{null==e||e.addEventListener("click",(o=>i(void 0,void 0,void 0,(function*(){const i=+o.target.id.split("start-engine-car-")[1];yield t.startDriving(i,e,n,r,a)}))))})(s,l,n,r),((e,n,r)=>{null==n||n.addEventListener("click",(a=>i(void 0,void 0,void 0,(function*(){const i=+a.target.id.split("stop-engine-car-")[1];t.stopDriving(i,e,n,r)}))))})(s,l,n),c.addStartButtons(s),c.addStopButtons(l),c.addFlags(r),c.addCarElements(n),a.createComponent("div","car-control-panel",[s,l],null)}},565:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.carImage=void 0;const i=n(310);n(18),t.carImage=e=>{const t=i.createComponent("object","car-image",null,null,["type","image/svg+xml"],["data","./car.svg"]);return t.addEventListener("load",(()=>{const n=t.getSVGDocument(),i=null==n?void 0:n.children[0];null==i||i.setAttribute("fill",`${e}`)})),t}},569:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createColorPicker=void 0;const i=n(310);t.createColorPicker=(e,...t)=>i.createComponent("input","color-picker",null,null,["type","color"],["name","color"],["id",`${e}`],...t)},563:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ControlPanel=void 0;const r=n(203),a=n(310),o=n(314),s=n(593),d=n(113),c=n(569),l=n(785),u=n(69);n(748);class h{constructor(){this.controlPanel=a.createComponent("div","control-panel",null,null),this.nameInput=u.createInput(!1,["name","name"],["id","create-name"]),this.colorPickerForCreate=c.createColorPicker("create-color"),this.createCarButton=d.createButton("create","button_secondary",["type","submit"]),this.nameUpdateInput=u.createInput(!0,["name","name"],["id","update-name"]),this.colorPickerForUpdate=c.createColorPicker("update-color",["disabled",""]),this.updateCarButton=d.createButton("update","button_secondary",["id","update-submit"],["type","submit"],["disabled",""]),h.raceButton=d.createButton("race","button_primary",["id","race"]),this.resetButton=d.createButton("reset","button_primary",["id","reset"]),this.generateCarsButton=d.createButton("generate","button_secondary",["id","generator"]),this.render(),this.listnerCreateCar(),this.listnerUpdateCar(),this.listnerGenerateCars(),this.listenerRace(),this.listenerReset(),this.garage=l.Garage.getInstance(),this.state=o.States.getInstance()}static getInstance(){return h.instance||(h.instance=new h),h.instance}getControlPanel(){return this.controlPanel}static setDisabledRaceButton(e){h.raceButton.disabled=e}listenerReset(){this.resetButton.addEventListener("click",(e=>i(this,void 0,void 0,(function*(){e.preventDefault(),h.raceButton.disabled=!1,yield s.resetAll()}))))}listenerRace(){h.raceButton.addEventListener("click",(e=>i(this,void 0,void 0,(function*(){e.preventDefault(),h.raceButton.disabled=!0,this.resetButton.disabled=!1,this.state.setWinner(null),yield s.raceAll()}))))}listnerCreateCar(){var e;this.createCarButton.addEventListener("submit",(e=>{e.preventDefault()})),null===(e=this.createCarsForm)||void 0===e||e.addEventListener("submit",(e=>i(this,void 0,void 0,(function*(){e.preventDefault();const t={name:this.nameInput.value,color:this.colorPickerForCreate.value};this.nameInput.value="",this.colorPickerForCreate.value="#000000",yield r.createCar(t),yield this.garage.renderGarage()}))))}listnerUpdateCar(){var e;this.updateCarButton.addEventListener("submit",(e=>{e.preventDefault()})),null===(e=this.updateCarsForm)||void 0===e||e.addEventListener("submit",(e=>i(this,void 0,void 0,(function*(){e.preventDefault();const t={name:this.nameUpdateInput.value,color:this.colorPickerForUpdate.value};this.nameInput.value="",this.colorPickerForCreate.value="#000000",yield r.updateCar(+this.state.getSelectedCar().id,t),yield this.garage.renderGarage(),this.nameUpdateInput.value="",this.colorPickerForUpdate.value="#000000",this.nameUpdateInput.disabled=!0,this.colorPickerForUpdate.disabled=!0,this.updateCarButton.disabled=!0}))))}listnerGenerateCars(){this.generateCarsButton.addEventListener("click",(()=>i(this,void 0,void 0,(function*(){this.generateCarsButton.disabled=!0;const e=s.generateRandomCars();yield Promise.all(e.map((e=>i(this,void 0,void 0,(function*(){return r.createCar(e)}))))),yield this.garage.renderGarage(),this.generateCarsButton.disabled=!1}))))}setUpdateName(e){this.nameUpdateInput.value=e}disableUpdateName(e){this.nameUpdateInput.disabled=e}setUpdateColorPicker(e){this.colorPickerForUpdate.value=e}getUpdateNameField(){return this.nameUpdateInput}render(){this.createCarsForm=s.createForm(this.controlPanel,"panel-row","create",this.nameInput,this.colorPickerForCreate,this.createCarButton),this.updateCarsForm=s.createForm(this.controlPanel,"panel-row","update",this.nameUpdateInput,this.colorPickerForUpdate,this.updateCarButton),s.createRow(this.controlPanel,"panel-row",h.raceButton,this.resetButton,this.generateCarsButton)}}t.ControlPanel=h},785:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Garage=void 0;const r=n(314),a=n(923),o=n(673),s=n(310);n(272);const d=n(563);class c{constructor(){this.states=r.States.getInstance(),this.heading=a.createHeading("Garage",this.states.getCarsCount(),!0),this.pageHeading=a.createHeading("Page",this.states.getNumberPage(),!1),this.garag=s.createComponent("div","garage",null,null),this.prevButton=s.createComponent("button","button button_secondary","prev",null,["disabled",""]),this.nextButton=s.createComponent("button","button button_secondary","next",null,["disabled",""]),this.paginationWrapper=s.createComponent("div","pagination-wrapper",[this.prevButton,this.nextButton],null),this.garag.append(this.heading,this.pageHeading,this.paginationWrapper),(()=>{i(this,void 0,void 0,(function*(){yield this.renderGarage()}))})(),this.paginationButtonListener()}getGarage(){return this.garag}static getInstance(){return c.instance||(c.instance=new c),c.instance}renderTitle(){this.heading.innerHTML=`Garage (${this.states.getCarsCount()})`,this.pageHeading.innerHTML=`Page #${this.states.getNumberPage()}`,this.garag.append(this.heading,this.pageHeading)}renderPaginationButton(e,t){this.nextButton.disabled=!(7*e<t),this.prevButton.disabled=!(e>1),this.garag.append(this.paginationWrapper)}paginationButtonListener(){this.prevButton.addEventListener("click",(()=>i(this,void 0,void 0,(function*(){this.states.setNumberPage(this.states.getNumberPage()-1),yield this.states.setStartData(),this.garag.innerHTML="",this.states.clearCarRace(),yield this.renderGarage()})))),this.nextButton.addEventListener("click",(()=>i(this,void 0,void 0,(function*(){this.states.setNumberPage(this.states.getNumberPage()+1),yield this.states.setStartData(),this.garag.innerHTML="",this.states.clearCarRace(),yield this.renderGarage()}))))}renderGarage(){return i(this,void 0,void 0,(function*(){yield this.states.setStartData(),this.garag.innerHTML="",this.renderTitle(),this.states.clearStartButtons(),this.states.clearStopButtons(),this.states.clearFlags(),this.states.clearCarElements(),d.ControlPanel.setDisabledRaceButton(!1),this.states.getCars().map((e=>this.garag.append(o.renderRoad(e)))),this.renderPaginationButton(this.states.getNumberPage(),this.states.getCarsCount())}))}}t.Garage=c},657:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.createGeneralButton=void 0;const r=n(203),a=n(310),o=n(314),s=n(113),d=n(785);let c,l;n(974);let u=null;t.createGeneralButton=(e,t)=>{l=s.createButton("Select","button_secondary",["id",`select-car-${e}`]),i(void 0,void 0,void 0,(function*(){const e=o.States.getInstance();null==l||l.addEventListener("click",(t=>i(void 0,void 0,void 0,(function*(){u=yield r.getCar(+t.target.id.split("select-car-")[1]),e.setSelectedCar(u),document.getElementById("update-name").value=u.name,document.getElementById("update-color").value=u.color,document.getElementById("update-name").disabled=!1,document.getElementById("update-color").disabled=!1,document.getElementById("update-submit").disabled=!1}))))})),c=s.createButton("Remove","button_secondary",["id",`remove-car-${e}`]),i(void 0,void 0,void 0,(function*(){const e=d.Garage.getInstance();null==c||c.addEventListener("click",(t=>i(void 0,void 0,void 0,(function*(){const n=+t.target.id.split("remove-car-")[1];yield r.deleteCar(n),yield r.deleteWinner(n),yield e.renderGarage()}))))}));const n=a.createComponent("span","car-name",`${t}`,null);return a.createComponent("div","general-buttons",[l,c,n],null)}},977:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.header=void 0;const i=n(310),r=n(113),a=n(563),o=n(785),s=n(854);let d,c;n(528);const l=o.Garage.getInstance().getGarage(),u=a.ControlPanel.getInstance().getControlPanel();t.header=()=>(d=r.createButton("to garage","button_primary"),c=r.createButton("to winners","button_primary"),null==c||c.addEventListener("click",(()=>{s.winnerList(),l.classList.add("invisible"),u.classList.add("invisible"),s.wrapper.classList.remove("invisible")})),null==d||d.addEventListener("click",(()=>{l.classList.remove("invisible"),u.classList.remove("invisible"),s.wrapper.classList.add("invisible")})),i.createComponent("header","header",[d,c],null))},923:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createHeading=void 0;const i=n(310);n(234),t.createHeading=(e,t,n)=>{const r=n?`${e} (${t})`:`${e} #${t}`;return i.createComponent("h2",n?"":"heading_middle",r,null)}},69:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createInput=void 0;const i=n(310);n(954),t.createInput=(e,...t)=>i.createComponent("input","text-input",null,null,[`${e?"disabled":null}`,""],...t)},673:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.renderRoad=void 0;const i=n(310),r=n(593),a=n(166),o=n(565),s=n(657);n(556),t.renderRoad=({id:e,name:t,color:n,isEngineStarted:d})=>{const c=s.createGeneralButton(e,t),l=o.carImage(n),u=i.createComponent("div","car",l,null,["id",`car-${e}`]),h=i.createComponent("img","flag",null,null,["src","./flag.svg"],["id",`flag-${e}`]),p=a.carControlPanel(e,u,h,d),g=r.createRow(null,"section-car-row",p,u,h);return i.createComponent("div","section-car",[c,g],null)}},854:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.winnerList=t.wrapper=void 0;const r=n(310),a=n(314),o=n(565),s=n(923);n(517);const d=a.States.getInstance(),c=s.createHeading("Garage",d.getWinnersCount(),!0),l=s.createHeading("Page",d.getWinnersPage(),!1),u=r.createComponent("button","button button_secondary","prev",null,["disabled",""]),h=r.createComponent("button","button button_secondary","next",null,["disabled",""]),p=r.createComponent("div","pagination-wrapper",[u,h],null),g=r.createComponent("th","th-id","Number",null),v=r.createComponent("th","","Car",null),m=r.createComponent("th","","Name",null),f=r.createComponent("th","th-wins","Wins",null),C=r.createComponent("th","th-time","Best time (seconds)",null),y=r.createComponent("thead","",[g,v,m,f,C],null),b=r.createComponent("tbody","",null,null),w=r.createComponent("table","winner-list",[y,b],null);t.wrapper=r.createComponent("div","winner-wrapper invisible",w,null);t.winnerList=()=>(b.innerHTML="",i(void 0,void 0,void 0,(function*(){var e,n;yield d.setWinnerList(),c.innerHTML=`Winner (${d.getWinnersCount()})`,l.innerHTML=`Page #${d.getWinnersPage()}`,t.wrapper.append(c,l),d.getWinners().map(((e,t)=>{const n=r.createComponent("tr","",null,null);return r.createComponent("td","",`${t+1}`,n),r.createComponent("td","",o.carImage(e.car.color),n),r.createComponent("td","",`${e.car.name}`,n),r.createComponent("td","",`${e.wins}`,n),r.createComponent("td","",`${e.time}`,n),b.append(n)})),e=d.getWinnersPage(),n=d.getWinnersCount(),h.disabled=!(10*e<n),u.disabled=!(e>1),t.wrapper.append(p)})),t.wrapper);u.addEventListener("click",(()=>i(void 0,void 0,void 0,(function*(){d.setWinnerPage(d.getWinnersPage()-1),b.innerHTML="",yield d.setWinnerList(),t.winnerList()})))),h.addEventListener("click",(()=>i(void 0,void 0,void 0,(function*(){d.setWinnerPage(d.getWinnersPage()+1),b.innerHTML="",yield d.setWinnerList(),t.winnerList()})))),w.addEventListener("click",(e=>i(void 0,void 0,void 0,(function*(){(e=>{i(void 0,void 0,void 0,(function*(){e.target.classList.contains("th-wins")&&("wins"!==d.getSort()?(d.setSort("wins"),d.setOrder("ASC"),b.innerHTML="",yield d.setWinnerList(),t.winnerList()):("ASC"===d.getOrder()?d.setOrder("DESC"):d.setOrder("ASC"),yield d.setWinnerList(),t.winnerList()))}))})(e),(e=>{i(void 0,void 0,void 0,(function*(){e.target.classList.contains("th-time")&&("time"!==d.getSort()?(d.setSort("time"),d.setOrder("ASC"),b.innerHTML="",yield d.setWinnerList(),t.winnerList()):("ASC"===d.getOrder()?d.setOrder("DESC"):d.setOrder("ASC"),yield d.setWinnerList(),t.winnerList()))}))})(e),(e=>{i(void 0,void 0,void 0,(function*(){e.target.classList.contains("th-id")&&("id"!==d.getSort()?(d.setSort("id"),d.setOrder("ASC"),b.innerHTML="",yield d.setWinnerList(),t.winnerList()):("ASC"===d.getOrder()?d.setOrder("DESC"):d.setOrder("ASC"),yield d.setWinnerList(),t.winnerList()))}))})(e)}))))},314:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.States=void 0;const r=n(203);class a{constructor(){this.carsRace=[],this.page=1,this.pageWinners=1,this.cars=[],this.carsCount=0,this.winners=[],this.winnersCount=0,this.selectedCar={},this.animation={},this.startButtons=[],this.stopButtons=[],this.flags=[],this.carElements=[],this.winner=null,this.sort="id",this.order="ASC"}static getInstance(){return a.instance||(a.instance=new a),a.instance}getSort(){return this.sort}setSort(e){this.sort=e}getOrder(){return this.order}setOrder(e){this.order=e}getWinnersCount(){return this.winnersCount}getWinners(){return this.winners}setWinner(e){this.winner=e}getWinner(){return this.winner}setCarRace(e){this.carsRace.push(e)}clearCarRace(){this.carsRace=[]}getCarsRace(){return this.carsRace}clearCarElements(){this.carElements=[]}addCarElements(e){this.carElements.push(e)}getCarElements(){return this.carElements}clearStartButtons(){this.startButtons=[]}addStartButtons(e){this.startButtons.push(e)}getStartButtons(){return this.startButtons}clearStopButtons(){this.stopButtons=[]}addStopButtons(e){this.stopButtons.push(e)}getStopButtons(){return this.stopButtons}clearFlags(){this.flags=[]}addFlags(e){this.flags.push(e)}getFlags(){return this.flags}getAnimation(){return this.animation}setAnimation(e){this.animation=e}getSelectedCar(){return this.selectedCar}setSelectedCar(e){this.selectedCar=e}getCarsCount(){return this.carsCount}getNumberPage(){return this.page}setNumberPage(e){this.page=e}getWinnersPage(){return this.pageWinners}setWinnerPage(e){this.pageWinners=e}setWinnersPage(e){this.pageWinners=e}setStartData(){return i(this,void 0,void 0,(function*(){const{items:e,count:t}=yield r.getCars(this.page);this.cars=e,this.carsCount=t}))}setWinnerList(){return i(this,void 0,void 0,(function*(){const{items:e,count:t}=yield r.getWinners({page:this.pageWinners,limit:10,sort:this.sort,order:this.order});this.winners=e,this.winnersCount=t}))}getCars(){return this.cars}}t.States=a},593:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.generateRandomCars=t.animation=t.getDistanceBetweenElements=t.resetAll=t.raceAll=t.createForm=t.createRow=void 0;const r=n(203),a=n(310),o=n(166),s=n(314).States.getInstance();t.createRow=(e,t,...n)=>a.createComponent("div",`${t}`,[...n],e),t.createForm=(e,t,n,...i)=>a.createComponent("form",`${t}`,[...i],e,["id",`${n}`]),t.raceAll=()=>i(void 0,void 0,void 0,(function*(){const e=s.getStartButtons(),t=s.getStopButtons(),n=s.getCarElements(),a=s.getFlags();return s.getCars().map((({id:d},c)=>i(void 0,void 0,void 0,(function*(){const l=yield o.startDriving(d,e[c],t[c],n[c],a[c]);yield(e=>i(void 0,void 0,void 0,(function*(){const t=yield e;if(s.getCarsRace(),null==s.getWinner()&&t.success){s.setWinner(t),yield r.saveWinner(t);const e=s.getCars().find((e=>e.id===t.id)),n=document.createElement("h1");n.classList.add("winner"),n.innerHTML=`Winner: ${null==e?void 0:e.name}(${t.time})`,document.body.append(n),setTimeout((()=>{n.remove()}),5e3)}return s.getWinner()})))(l)})))),null})),t.resetAll=()=>i(void 0,void 0,void 0,(function*(){const e=s.getStartButtons(),t=s.getStopButtons(),n=s.getCarElements();s.clearCarRace(),s.getCars().map((({id:r},a)=>i(void 0,void 0,void 0,(function*(){yield o.stopDriving(r,e[a],t[a],n[a])}))))}));const d=["Mersedes","BMW","Toyota","Porshe","Lamborghini","Mazda","Audi","Bentley","Mitsubishi","Nissan"],c=["Outlander","W223","X7","Land Cruiser","Cayenne","Huracan","3","A3","Continental GT","GTR"],l=e=>{const{top:t,left:n,width:i,height:r}=e.getBoundingClientRect();return{x:n+i/2,y:t+r/2}};t.getDistanceBetweenElements=(e,t)=>{const n=l(e),i=l(t);return Math.hypot(n.x-i.x,n.y-i.y)},t.animation=(e,t,n)=>{let i=null;const r={id:0};return r.id=window.requestAnimationFrame((function a(o=Date.now()){i||(i=o);const s=o-i,d=Math.round(s*(t/n));e.style.transform=`translateX(${Math.min(d,t)}px)`,d<t&&(r.id=window.requestAnimationFrame(a))})),r};const u=()=>{let e="#";for(let t=0;t<6;t++)e+="123456789ABCDEF"[Math.floor(16*Math.random())];return e};t.generateRandomCars=(e=100)=>new Array(e).fill(1).map((()=>({name:`${d[Math.floor(Math.random()*d.length)]} ${c[Math.floor(Math.random()*c.length)]}`,color:u()})))}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var a=t[i]={exports:{}};return e[i].call(a.exports,a,a.exports,n),a.exports}n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=n(752),t=n(310),i=n(977);n(387),window.onload=()=>{const{body:n}=document,r=i.header(),a=t.createComponent("main","main",null,n);n.append(r,a),new e.App(a)}})()})();
